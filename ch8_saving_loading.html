<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CARLsim: Chapter 8: Saving and Loading</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="CARLsimStyles.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CARLsim
   &#160;<span id="projectnumber">3.1.3</span>
   </div>
   <div id="projectbrief">CARLsim: a GPU-accelerated SNN simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="usergroup0.html"><span>User&#160;Guide</span></a></li>
      <li><a href="usergroup1.html"><span>Tutorial</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ch8_saving_loading.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Chapter 8: Saving and Loading </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ch8s1_savesimulation">8.1 Saving a Simulation File</a></li>
<li class="level1"><a href="#ch8s2_loadsimulation">8.2 Loading a Simulation File</a></li>
</ul>
</div>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Kristofor D. Carlson </dd>
<dd>
Michael Beyeler</dd></dl>
<p>Once a network has reached <a class="el" href="carlsim__datastructures_8h.html#acd26718cf4fb3a423ffe7d3ef7f5b18ca033f2f21470e4f79d5dc459619a6980c" title="setup state, where the neural network is prepared for execution and monitors are set ...">SETUP_STATE</a> or <a class="el" href="carlsim__datastructures_8h.html#acd26718cf4fb3a423ffe7d3ef7f5b18ca67606f8f4ae6a12252ebcf0ddc2cc652" title="run state, where the model is stepped ">RUN_STATE</a>, the network state can be stored in a file for later processing or for restoring a specific network using the <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file. ">CARLsim::saveSimulation</a> function. The network state consists of all the synaptic connections, weights, delays, and whether the connections are plastic or fixed. The network state data can be analyzed with the MATLAB <a class="el" href="classConnectionMonitor.html" title="Class ConnectionMonitor. ">ConnectionMonitor</a>.</p>
<p>Furthermore, the network state can be loaded from a file using the <a class="el" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722" title="Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...">CARLsim::loadSimulation</a> function call. However, this function can only be called in the <a class="el" href="carlsim__datastructures_8h.html#acd26718cf4fb3a423ffe7d3ef7f5b18cac7fa385000dcb927a21b44bce4fbfca9" title="configuration state, where the neural network is configured ">CONFIG_STATE</a>.</p>
<p>Saving and loading network state data can be especially time-saving when an SNN is extremely large or if it must be trained for a long period of time. After training for the first run is completed and saved to file, subsequent testing runs will be much faster.</p>
<h1><a class="anchor" id="ch8s1_savesimulation"></a>
8.1 Saving a Simulation File</h1>
<p>A network can be saved at any time in <a class="el" href="carlsim__datastructures_8h.html#acd26718cf4fb3a423ffe7d3ef7f5b18ca033f2f21470e4f79d5dc459619a6980c" title="setup state, where the neural network is prepared for execution and monitors are set ...">SETUP_STATE</a> or <a class="el" href="carlsim__datastructures_8h.html#acd26718cf4fb3a423ffe7d3ef7f5b18ca67606f8f4ae6a12252ebcf0ddc2cc652" title="run state, where the model is stepped ">RUN_STATE</a>, for as many times as desired, via <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file. ">CARLsim::saveSimulation</a>: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="carlsim_8h.html">carlsim.h</a>&gt;</span></div><div class="line"><a class="code" href="classCARLsim.html">CARLsim</a> sim(<span class="stringliteral">&quot;saveSim&quot;</span>, <a class="code" href="carlsim__datastructures_8h.html#a14838da6840920e8872a5620470f1522a729ca642c452f8a7c53df4a48f240537">CPU_MODE</a>, <a class="code" href="carlsim__datastructures_8h.html#ace95bf2edf06bd0708c106dfe43271edae2d30a195cee6b2961cc2c23ea4b520b">USER</a>);</div><div class="line"></div><div class="line"><span class="comment">// configure a network</span></div><div class="line"><span class="keywordtype">int</span> gOut = sim.<a class="code" href="classCARLsim.html#a25e7f1c64cf9382794306765b7e2c471">createGroup</a>(<span class="stringliteral">&quot;gOut&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div><div class="line"><span class="keywordtype">int</span> gIn  = sim.<a class="code" href="classCARLsim.html#af793fdeaeb87b58bea9395aeaa106851">createSpikeGeneratorGroup</a>(<span class="stringliteral">&quot;gIn&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div><div class="line">sim.<a class="code" href="classCARLsim.html#aebfce9be7d21575bf22cd500b596b1c8">connect</a>(gIn, gOut, <span class="stringliteral">&quot;one-to-one&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.1f), 0.1f);</div><div class="line"><span class="comment">// .. etc.</span></div><div class="line"></div><div class="line">sim.<a class="code" href="classCARLsim.html#ab74a86f8f1dc5dc1cfdaa62d7ebe4fc0">setupNetwork</a>();</div><div class="line"></div><div class="line"><span class="comment">// save initial network</span></div><div class="line">sim.<a class="code" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed">saveSimulation</a>(<span class="stringliteral">&quot;networkA.dat&quot;</span>, <span class="keyword">true</span>); <span class="comment">// fileName, saveSynapseInfo</span></div><div class="line"></div><div class="line"><span class="comment">// perform experiment, which might include synaptic plasticity and/or a training phase</span></div><div class="line"><span class="comment">// etc.</span></div><div class="line">sim.<a class="code" href="classCARLsim.html#a21d26bbb824e06f67cb035de583ad193">runNetwork</a>(1,0);</div><div class="line"></div><div class="line"><span class="comment">// store network at the end of training</span></div><div class="line">sim.<a class="code" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed">saveSimulation</a>(<span class="stringliteral">&quot;networkZ.dat&quot;</span>, <span class="keyword">true</span>); <span class="comment">// fileName, saveSynapseInfo</span></div></div><!-- fragment --><p> where the user specifies a filename (e.g., "networkA.dat") and a flag whether or not to store the synapse information. In this example, "networkA.dat" will contain the network state at the beginning of the experiment, and "networkZ.dat" will contain the network state at the end of the experiment (which might be different from the beginning if there is synaptic plasticity enabled). If the flag <code>saveSynapseInfo</code> is set to true, the method will store all the synaptic connections, weights, delays, and whether the connections are plastic or fixed. The value of this flag is <code>true</code> by default.</p>
<h1><a class="anchor" id="ch8s2_loadsimulation"></a>
8.2 Loading a Simulation File</h1>
<p>Past <a class="el" href="classCARLsim.html" title="CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...">CARLsim</a> networks can be loaded from file by setting up the same number of groups, connections, and neurons as was used to store the network via <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file. ">CARLsim::saveSimulation</a>, and then calling <a class="el" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722" title="Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...">CARLsim::loadSimulation</a> to overwrite all corresponding synaptic weight and delay values from file.</p>
<p>The following code snippet configures a network and calls <a class="el" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722" title="Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...">CARLsim::loadSimulation</a> with a file pointer to "networkA.dat", which is a file that was created with <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file. ">CARLsim::saveSimulation</a> and flag <code>saveSynapseInfo</code> set to <code>true</code>: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="carlsim_8h.html">carlsim.h</a>&gt;</span></div><div class="line"><a class="code" href="classCARLsim.html">CARLsim</a> sim(<span class="stringliteral">&quot;loadSim&quot;</span>, <a class="code" href="carlsim__datastructures_8h.html#a14838da6840920e8872a5620470f1522a729ca642c452f8a7c53df4a48f240537">CPU_MODE</a>, <a class="code" href="carlsim__datastructures_8h.html#ace95bf2edf06bd0708c106dfe43271edae2d30a195cee6b2961cc2c23ea4b520b">USER</a>);</div><div class="line"></div><div class="line"><span class="comment">// configure the same network used with saveSimulation</span></div><div class="line"><span class="keywordtype">int</span> gOut = sim.<a class="code" href="classCARLsim.html#a25e7f1c64cf9382794306765b7e2c471">createGroup</a>(<span class="stringliteral">&quot;gOut&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div><div class="line"><span class="keywordtype">int</span> gIn  = sim.<a class="code" href="classCARLsim.html#af793fdeaeb87b58bea9395aeaa106851">createSpikeGeneratorGroup</a>(<span class="stringliteral">&quot;gIn&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div><div class="line">sim.<a class="code" href="classCARLsim.html#aebfce9be7d21575bf22cd500b596b1c8">connect</a>(gIn, gOut, <span class="stringliteral">&quot;one-to-one&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.1f), 0.1f);</div><div class="line"><span class="comment">// .. etc.</span></div><div class="line"></div><div class="line"><span class="comment">// before calling setupNetwork, call loadSimulation</span></div><div class="line">FILE* fId = NULL;</div><div class="line">simFid = fopen(<span class="stringliteral">&quot;networkA.dat&quot;</span>, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line">sim.<a class="code" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722">loadSimulation</a>(fId);</div><div class="line"><span class="comment">// don&#39;t fclose fId yet ...</span></div><div class="line"></div><div class="line">sim.<a class="code" href="classCARLsim.html#ab74a86f8f1dc5dc1cfdaa62d7ebe4fc0">setupNetwork</a>();</div><div class="line"></div><div class="line"><span class="comment">// ... wait until after setupNetwork is called</span></div><div class="line">fclose(fId);</div><div class="line"></div><div class="line"><span class="comment">// perform experiment, etc.</span></div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>In order for <a class="el" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722" title="Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...">CARLsim::loadSimulation</a> to work, the configured network must have the identical number of groups, connections, and neurons as the one stored with <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file. ">CARLsim::saveSimulation</a>. </dd>
<dd>
In addition, <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file. ">CARLsim::saveSimulation</a> must have been called with flag <code>saveSynapseInfo</code> set to <code>true</code>. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Wait with calling fclose on the file pointer until <a class="el" href="carlsim__datastructures_8h.html#acd26718cf4fb3a423ffe7d3ef7f5b18ca033f2f21470e4f79d5dc459619a6980c" title="setup state, where the neural network is prepared for execution and monitors are set ...">SETUP_STATE</a>! </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Apr 13 2017 14:44:27 for CARLsim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
